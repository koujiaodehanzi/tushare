<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tushareæ•°æ®åŒæ­¥ç³»ç»Ÿ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .header-nav {
            margin-top: 20px;
        }

        .header-nav a {
            display: inline-block;
            padding: 10px 24px;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            text-decoration: none;
            border-radius: 6px;
            margin: 0 10px;
            transition: all 0.3s;
            backdrop-filter: blur(10px);
        }

        .header-nav a:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }

        .main-grid {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .sync-section {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .sync-section.daily-sync {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .sync-section.daily-sync .section-title {
            grid-column: 1 / -1;
        }

        .section-title {
            background: white;
            padding: 15px 20px;
            border-radius: 12px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            text-align: center;
            font-size: 1.4em;
            font-weight: 600;
            color: #667eea;
            border-bottom: 3px solid #667eea;
        }

        .sync-card {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: transform 0.2s;
        }

        .sync-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 12px rgba(0, 0, 0, 0.15);
        }

        .sync-card h3 {
            color: #333;
            margin-bottom: 15px;
            font-size: 1.3em;
            border-bottom: 2px solid #667eea;
            padding-bottom: 10px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            color: #555;
            margin-bottom: 5px;
            font-weight: 500;
        }

        .form-group input {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
            transition: border-color 0.3s;
        }

        .form-group input:focus {
            outline: none;
            border-color: #667eea;
        }

        .btn {
            width: 100%;
            padding: 12px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 10px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: scale(1.02);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }

        .btn-primary:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        .result {
            margin-top: 15px;
            padding: 12px;
            border-radius: 6px;
            font-size: 14px;
            display: none;
            white-space: pre-line;
            line-height: 1.6;
        }

        .result.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
            display: block;
        }

        .result.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
            display: block;
        }

        .result.loading {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
            display: block;
        }

        .status-panel {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .status-panel h3 {
            color: #333;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .status-item {
            padding: 10px;
            margin-bottom: 10px;
            border-radius: 6px;
            background: #f8f9fa;
            font-size: 14px;
        }

        .hint {
            font-size: 12px;
            color: #888;
            margin-top: 5px;
        }

        @media (max-width: 768px) {
            .main-grid {
                grid-template-columns: 1fr;
            }

            .sync-section.daily-sync {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ“Š Tushareæ•°æ®åŒæ­¥ç³»ç»Ÿ</h1>
            <p>è‚¡ç¥¨æ•°æ®é‡‡é›†ä¸åŒæ­¥ç®¡ç†å¹³å°</p>
            <div class="header-nav">
                <a href="/stock_list.html">ğŸ“ˆ è‚¡ç¥¨åˆ—è¡¨</a>
                <a href="/backtest.html">ğŸ“Š ç­–ç•¥å›æµ‹</a>
                <a href="/">ğŸ”„ æ•°æ®åŒæ­¥</a>
            </div>
        </div>

        <div class="main-grid">
            <!-- å·¦ä¾§ï¼šåŸºç¡€æ•°æ®åŒæ­¥ -->
            <div class="sync-section">
                <div class="section-title">ğŸ“¦ åŸºç¡€æ•°æ®åŒæ­¥</div>
                
                <!-- åŸºç¡€æ•°æ®å…¨é‡åŒæ­¥ -->
                <div class="sync-card">
                    <h3>ğŸ—‚ï¸ å…¨é‡åŒæ­¥</h3>
                    <p style="color: #666; margin-bottom: 15px;">åŒæ­¥è‚¡ç¥¨åˆ—è¡¨ã€è‚¡ä¸œæŒè‚¡ã€æ¸¸èµ„åå½•ç­‰åŸºç¡€æ•°æ®</p>
                    <button class="btn btn-primary" onclick="syncBase()">å¼€å§‹åŒæ­¥</button>
                    <div id="result-base" class="result"></div>
                </div>

                <!-- è‚¡ç¥¨åˆ—è¡¨åŒæ­¥ -->
                <div class="sync-card">
                    <h3>ğŸ“‹ è‚¡ç¥¨åˆ—è¡¨</h3>
                    <p style="color: #666; margin-bottom: 15px;">åŒæ­¥æ‰€æœ‰è‚¡ç¥¨åŸºæœ¬ä¿¡æ¯</p>
                    <button class="btn btn-primary" onclick="syncStockList()">å¼€å§‹åŒæ­¥</button>
                    <div id="result-stock-list" class="result"></div>
                </div>

                <!-- è‚¡ä¸œæŒè‚¡åŒæ­¥ -->
                <div class="sync-card">
                    <h3>ğŸ‘¥ è‚¡ä¸œæŒè‚¡</h3>
                    <p style="color: #666; margin-bottom: 15px;">åŒæ­¥æœ€æ–°è‚¡ä¸œæŒè‚¡æ•°æ®</p>
                    <button class="btn btn-primary" onclick="syncStockHolder()">å¼€å§‹åŒæ­¥</button>
                    <div id="result-stock-holder" class="result"></div>
                </div>

                <!-- æ¸¸èµ„åå½•åŒæ­¥ -->
                <div class="sync-card">
                    <h3>ğŸ’° æ¸¸èµ„åå½•</h3>
                    <p style="color: #666; margin-bottom: 15px;">åŒæ­¥æ¸¸èµ„å¸­ä½ä¿¡æ¯</p>
                    <button class="btn btn-primary" onclick="syncHotMoney()">å¼€å§‹åŒæ­¥</button>
                    <div id="result-hot-money" class="result"></div>
                </div>
            </div>

            <!-- å³ä¾§ï¼šæ¯æ—¥æ•°æ®åŒæ­¥ -->
            <div class="sync-section daily-sync">
                <div class="section-title">ğŸ“Š æ¯æ—¥æ•°æ®åŒæ­¥</div>
                
                <!-- å•æ—¥æ•°æ®åŒæ­¥ -->
                <div class="sync-card">
                    <h3>ğŸ“… å•æ—¥å…¨é‡åŒæ­¥</h3>
                    <div class="form-group">
                        <label>è‚¡ç¥¨ä»£ç ï¼ˆç•™ç©ºåˆ™åŒæ­¥æ‰€æœ‰ï¼Œå¤šä¸ªç”¨é€—å·åˆ†éš”ï¼‰</label>
                        <input type="text" id="daily_ts_code" placeholder="000001,000002">
                    </div>
                    <div class="form-group">
                        <label>äº¤æ˜“æ—¥æœŸ</label>
                        <input type="text" id="trade_date" placeholder="20251212" maxlength="8">
                        <div class="hint">æ ¼å¼ï¼šYYYYMMDDï¼Œå¦‚ 20251212</div>
                    </div>
                    <button class="btn btn-primary" onclick="syncDaily()">å¼€å§‹åŒæ­¥</button>
                    <div id="result-daily" class="result"></div>
                </div>

                <!-- æ—¥æœŸèŒƒå›´åŒæ­¥ -->
                <div class="sync-card">
                    <h3>ğŸ“† èŒƒå›´å…¨é‡åŒæ­¥</h3>
                    <div class="form-group">
                        <label>è‚¡ç¥¨ä»£ç ï¼ˆç•™ç©ºåˆ™åŒæ­¥æ‰€æœ‰ï¼Œå¤šä¸ªç”¨é€—å·åˆ†éš”ï¼‰</label>
                        <input type="text" id="range_ts_code" placeholder="000001,000002">
                    </div>
                    <div class="form-group">
                        <label>å¼€å§‹æ—¥æœŸ</label>
                        <input type="text" id="start_date" placeholder="20251201" maxlength="8">
                    </div>
                    <div class="form-group">
                        <label>ç»“æŸæ—¥æœŸ</label>
                        <input type="text" id="end_date" placeholder="20251212" maxlength="8">
                    </div>
                    <button class="btn btn-primary" onclick="syncRange()">å¼€å§‹åŒæ­¥</button>
                    <div id="result-range" class="result"></div>
                </div>

                <!-- æ—¥çº¿è¡Œæƒ… -->
                <div class="sync-card">
                    <h3>ğŸ“ˆ æ—¥çº¿è¡Œæƒ…</h3>
                    <div class="form-group">
                        <label>è‚¡ç¥¨ä»£ç </label>
                        <input type="text" id="daily_ts_code" placeholder="000001">
                    </div>
                    <div class="form-group">
                        <label>äº¤æ˜“æ—¥æœŸ</label>
                        <input type="text" id="daily_trade_date" placeholder="20251212" maxlength="8">
                    </div>
                    <button class="btn btn-primary" onclick="syncStockDailySingle()">å¼€å§‹åŒæ­¥</button>
                    <div id="result-stock-daily" class="result"></div>
                </div>

                <!-- ç­¹ç åˆ†å¸ƒ -->
                <div class="sync-card">
                    <h3>ğŸ¯ ç­¹ç åˆ†å¸ƒ</h3>
                    <div class="form-group">
                        <label>è‚¡ç¥¨ä»£ç ï¼ˆç•™ç©ºåˆ™åŒæ­¥æ‰€æœ‰ï¼‰</label>
                        <input type="text" id="chip_ts_code" placeholder="000001">
                    </div>
                    <div class="form-group">
                        <label>å¼€å§‹æ—¥æœŸ</label>
                        <input type="text" id="chip_start_date" placeholder="20251201" maxlength="8">
                    </div>
                    <div class="form-group">
                        <label>ç»“æŸæ—¥æœŸ</label>
                        <input type="text" id="chip_end_date" placeholder="20251212" maxlength="8">
                    </div>
                    <button class="btn btn-primary" onclick="syncStockChipSingle()">å¼€å§‹åŒæ­¥</button>
                    <div id="result-stock-chip" class="result"></div>
                </div>

                <!-- æŠ€æœ¯å› å­ -->
                <div class="sync-card">
                    <h3>ğŸ“Š æŠ€æœ¯å› å­</h3>
                    <div class="form-group">
                        <label>è‚¡ç¥¨ä»£ç ï¼ˆç•™ç©ºåˆ™åŒæ­¥æ‰€æœ‰ï¼‰</label>
                        <input type="text" id="tech_ts_code" placeholder="000001">
                    </div>
                    <div class="form-group">
                        <label>å¼€å§‹æ—¥æœŸ</label>
                        <input type="text" id="tech_start_date" placeholder="20251201" maxlength="8">
                    </div>
                    <div class="form-group">
                        <label>ç»“æŸæ—¥æœŸ</label>
                        <input type="text" id="tech_end_date" placeholder="20251212" maxlength="8">
                    </div>
                    <button class="btn btn-primary" onclick="syncStockTechFactorSingle()">å¼€å§‹åŒæ­¥</button>
                    <div id="result-stock-tech" class="result"></div>
                </div>

                <!-- æŠ€æœ¯å› å­ä¸“ä¸šç‰ˆ -->
                <div class="sync-card">
                    <h3>ğŸ“Š æŠ€æœ¯å› å­(ä¸“ä¸šç‰ˆ)</h3>
                    <div class="form-group">
                        <label>è‚¡ç¥¨ä»£ç ï¼ˆç•™ç©ºåˆ™åŒæ­¥æ‰€æœ‰ï¼‰</label>
                        <input type="text" id="tech_pro_ts_code" placeholder="000001">
                    </div>
                    <div class="form-group">
                        <label>å¼€å§‹æ—¥æœŸ</label>
                        <input type="text" id="tech_pro_start_date" placeholder="20251201" maxlength="8">
                    </div>
                    <div class="form-group">
                        <label>ç»“æŸæ—¥æœŸ</label>
                        <input type="text" id="tech_pro_end_date" placeholder="20251212" maxlength="8">
                    </div>
                    <button class="btn btn-primary" onclick="syncStockTechFactorProSingle()">å¼€å§‹åŒæ­¥</button>
                    <div id="result-stock-tech-pro" class="result"></div>
                </div>

                <!-- åŒèŠ±é¡ºä¸ªè‚¡èµ„é‡‘æµ -->
                <div class="sync-card">
                    <h3>ğŸ’° åŒèŠ±é¡ºä¸ªè‚¡èµ„é‡‘æµ</h3>
                    <div class="form-group">
                        <label>å¼€å§‹æ—¥æœŸ</label>
                        <input type="text" id="money_ths_start_date" placeholder="20251201" maxlength="8">
                    </div>
                    <div class="form-group">
                        <label>ç»“æŸæ—¥æœŸ</label>
                        <input type="text" id="money_ths_end_date" placeholder="20251212" maxlength="8">
                    </div>
                    <button class="btn btn-primary" onclick="syncStockMoneyFlowThs()">å¼€å§‹åŒæ­¥</button>
                    <div id="result-stock-money-ths" class="result"></div>
                </div>

                <!-- ä¸œæ–¹è´¢å¯Œä¸ªè‚¡èµ„é‡‘æµ -->
                <div class="sync-card">
                    <h3>ğŸ’° ä¸œæ–¹è´¢å¯Œä¸ªè‚¡èµ„é‡‘æµ</h3>
                    <div class="form-group">
                        <label>å¼€å§‹æ—¥æœŸ</label>
                        <input type="text" id="money_dc_start_date" placeholder="20251201" maxlength="8">
                    </div>
                    <div class="form-group">
                        <label>ç»“æŸæ—¥æœŸ</label>
                        <input type="text" id="money_dc_end_date" placeholder="20251212" maxlength="8">
                    </div>
                    <button class="btn btn-primary" onclick="syncStockMoneyFlowDc()">å¼€å§‹åŒæ­¥</button>
                    <div id="result-stock-money-dc" class="result"></div>
                </div>

                <!-- æ¿å—èµ„é‡‘æµ -->
                <div class="sync-card">
                    <h3>ğŸ“¦ æ¿å—èµ„é‡‘æµ</h3>
                    <div class="form-group">
                        <label>å¼€å§‹æ—¥æœŸ</label>
                        <input type="text" id="block_start_date" placeholder="20251201" maxlength="8">
                    </div>
                    <div class="form-group">
                        <label>ç»“æŸæ—¥æœŸ</label>
                        <input type="text" id="block_end_date" placeholder="20251212" maxlength="8">
                    </div>
                    <button class="btn btn-primary" onclick="syncBlockMoneyFlowSingle()">å¼€å§‹åŒæ­¥</button>
                    <div id="result-block-money" class="result"></div>
                </div>

                <!-- ä¸œæ–¹è´¢å¯Œæ¿å—èµ„é‡‘æµ -->
                <div class="sync-card">
                    <h3>ğŸ“¦ ä¸œæ–¹è´¢å¯Œæ¿å—èµ„é‡‘æµ</h3>
                    <div class="form-group">
                        <label>å¼€å§‹æ—¥æœŸ</label>
                        <input type="text" id="block_dc_start_date" placeholder="20251201" maxlength="8">
                    </div>
                    <div class="form-group">
                        <label>ç»“æŸæ—¥æœŸ</label>
                        <input type="text" id="block_dc_end_date" placeholder="20251212" maxlength="8">
                    </div>
                    <button class="btn btn-primary" onclick="syncBlockDcMoneyFlow()">å¼€å§‹åŒæ­¥</button>
                    <div id="result-block-dc-money" class="result"></div>
                </div>

                <!-- è¡Œä¸šèµ„é‡‘æµ -->
                <div class="sync-card">
                    <h3>ğŸ­ è¡Œä¸šèµ„é‡‘æµ</h3>
                    <div class="form-group">
                        <label>å¼€å§‹æ—¥æœŸ</label>
                        <input type="text" id="industry_start_date" placeholder="20251201" maxlength="8">
                    </div>
                    <div class="form-group">
                        <label>ç»“æŸæ—¥æœŸ</label>
                        <input type="text" id="industry_end_date" placeholder="20251212" maxlength="8">
                    </div>
                    <button class="btn btn-primary" onclick="syncIndustryMoneyFlowSingle()">å¼€å§‹åŒæ­¥</button>
                    <div id="result-industry-money" class="result"></div>
                </div>

                <!-- ä¸œæ–¹è´¢å¯Œè¡Œä¸šèµ„é‡‘æµ -->
                <div class="sync-card">
                    <h3>ğŸ­ ä¸œæ–¹è´¢å¯Œè¡Œä¸šèµ„é‡‘æµ</h3>
                    <div class="form-group">
                        <label>å¼€å§‹æ—¥æœŸ</label>
                        <input type="text" id="industry_dc_start_date" placeholder="20251201" maxlength="8">
                    </div>
                    <div class="form-group">
                        <label>ç»“æŸæ—¥æœŸ</label>
                        <input type="text" id="industry_dc_end_date" placeholder="20251212" maxlength="8">
                    </div>
                    <button class="btn btn-primary" onclick="syncIndustryDcMoneyFlow()">å¼€å§‹åŒæ­¥</button>
                    <div id="result-industry-dc-money" class="result"></div>
                </div>

                <!-- é¾™è™æ¦œæ¯æ—¥ -->
                <div class="sync-card">
                    <h3>ğŸ‰ é¾™è™æ¦œæ¯æ—¥</h3>
                    <div class="form-group">
                        <label>è‚¡ç¥¨ä»£ç ï¼ˆå¯é€‰ï¼‰</label>
                        <input type="text" id="lhb_ts_code" placeholder="000001">
                        <div class="hint">ç•™ç©ºåˆ™åŒæ­¥æ‰€æœ‰é¾™è™æ¦œè‚¡ç¥¨</div>
                    </div>
                    <div class="form-group">
                        <label>äº¤æ˜“æ—¥æœŸ</label>
                        <input type="text" id="lhb_trade_date" placeholder="20251212" maxlength="8">
                    </div>
                    <button class="btn btn-primary" onclick="syncStockLhbDailySingle()">å¼€å§‹åŒæ­¥</button>
                    <div id="result-lhb-daily" class="result"></div>
                </div>

                <!-- é¾™è™æ¦œæœºæ„ -->
                <div class="sync-card">
                    <h3>ğŸ¢ é¾™è™æ¦œæœºæ„</h3>
                    <div class="form-group">
                        <label>è‚¡ç¥¨ä»£ç ï¼ˆå¯é€‰ï¼‰</label>
                        <input type="text" id="lhb_inst_ts_code" placeholder="000001">
                        <div class="hint">ç•™ç©ºåˆ™åŒæ­¥æ‰€æœ‰é¾™è™æ¦œè‚¡ç¥¨</div>
                    </div>
                    <div class="form-group">
                        <label>äº¤æ˜“æ—¥æœŸ</label>
                        <input type="text" id="lhb_inst_trade_date" placeholder="20251212" maxlength="8">
                    </div>
                    <button class="btn btn-primary" onclick="syncStockLhbInstSingle()">å¼€å§‹åŒæ­¥</button>
                    <div id="result-lhb-inst" class="result"></div>
                </div>

                <!-- æ¶¨è·Œåœæ•°æ® -->
                <div class="sync-card">
                    <h3>ğŸ“ˆ æ¶¨è·Œåœæ•°æ®</h3>
                    <div class="form-group">
                        <label>å¼€å§‹æ—¥æœŸ</label>
                        <input type="text" id="limit_status_start_date" placeholder="20251201" maxlength="8">
                    </div>
                    <div class="form-group">
                        <label>ç»“æŸæ—¥æœŸ</label>
                        <input type="text" id="limit_status_end_date" placeholder="20251212" maxlength="8">
                    </div>
                    <button class="btn btn-primary" onclick="syncStockLimitStatusSingle()">å¼€å§‹åŒæ­¥</button>
                    <div id="result-limit-status" class="result"></div>
                </div>

                <!-- è¿æ¿å¤©æ¢¯ -->
                <div class="sync-card">
                    <h3>ğŸªœ è¿æ¿å¤©æ¢¯</h3>
                    <div class="form-group">
                        <label>äº¤æ˜“æ—¥æœŸ</label>
                        <input type="text" id="limit_ladder_trade_date" placeholder="20251212" maxlength="8">
                    </div>
                    <button class="btn btn-primary" onclick="syncStockLimitLadderSingle()">å¼€å§‹åŒæ­¥</button>
                    <div id="result-limit-ladder" class="result"></div>
                </div>

                <!-- å¼ºåŠ¿æ¿å— -->
                <div class="sync-card">
                    <h3>ğŸ’ª å¼ºåŠ¿æ¿å—</h3>
                    <div class="form-group">
                        <label>äº¤æ˜“æ—¥æœŸ</label>
                        <input type="text" id="block_strong_trade_date" placeholder="20251212" maxlength="8">
                    </div>
                    <button class="btn btn-primary" onclick="syncBlockLimitStrongSingle()">å¼€å§‹åŒæ­¥</button>
                    <div id="result-block-strong" class="result"></div>
                </div>

                <!-- æ¸¸èµ„æ¯æ—¥æ˜ç»† -->
                <div class="sync-card">
                    <h3>ğŸ’° æ¸¸èµ„æ¯æ—¥æ˜ç»†</h3>
                    <div class="form-group">
                        <label>è‚¡ç¥¨ä»£ç ï¼ˆç•™ç©ºåˆ™åŒæ­¥æ‰€æœ‰ï¼‰</label>
                        <input type="text" id="hm_daily_ts_code" placeholder="000001">
                    </div>
                    <div class="form-group">
                        <label>äº¤æ˜“æ—¥æœŸ</label>
                        <input type="text" id="hm_daily_trade_date" placeholder="20251212" maxlength="8">
                    </div>
                    <button class="btn btn-primary" onclick="syncStockHotMoneyDailySingle()">å¼€å§‹åŒæ­¥</button>
                    <div id="result-hm-daily" class="result"></div>
                </div>

                <!-- åŒèŠ±é¡ºæ¿å— -->
                <div class="sync-card">
                    <h3>ğŸ“Š åŒèŠ±é¡ºæ¿å—</h3>
                    <div class="form-group">
                        <label>æ¿å—ä»£ç ï¼ˆç•™ç©ºåˆ™å…¨éƒ¨ï¼‰</label>
                        <input type="text" id="ths_index_ts_code" placeholder="885800.TI">
                    </div>
                    <div class="form-group">
                        <label>å¸‚åœºç±»å‹</label>
                        <select id="ths_index_exchange">
                            <option value="">å…¨éƒ¨</option>
                            <option value="A">Aè‚¡</option>
                            <option value="HK">æ¸¯è‚¡</option>
                            <option value="US">ç¾è‚¡</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>æŒ‡æ•°ç±»å‹</label>
                        <select id="ths_index_type">
                            <option value="">å…¨éƒ¨</option>
                            <option value="N">æ¦‚å¿µæŒ‡æ•°</option>
                            <option value="I">è¡Œä¸šæŒ‡æ•°</option>
                            <option value="S">ç‰¹è‰²æŒ‡æ•°</option>
                        </select>
                    </div>
                    <button class="btn btn-primary" onclick="syncThsIndex()">å¼€å§‹åŒæ­¥</button>
                    <div id="result-ths-index" class="result"></div>
                </div>

                <!-- ä¸œæ–¹è´¢å¯Œæ¿å— -->
                <div class="sync-card">
                    <h3>ğŸ“Š ä¸œæ–¹è´¢å¯Œæ¿å—</h3>
                    <div class="form-group">
                        <label>æ¿å—ä»£ç ï¼ˆç•™ç©ºåˆ™å…¨éƒ¨ï¼‰</label>
                        <input type="text" id="dc_index_ts_code" placeholder="BK1184.DC">
                    </div>
                    <div class="form-group">
                        <label>æ¿å—åç§°ï¼ˆå¯é€‰ï¼‰</label>
                        <input type="text" id="dc_index_name" placeholder="äººå½¢æœºå™¨äºº">
                    </div>
                    <div class="form-group">
                        <label>äº¤æ˜“æ—¥æœŸï¼ˆå¯é€‰ï¼‰</label>
                        <input type="text" id="dc_index_trade_date" placeholder="20251219" maxlength="8">
                    </div>
                    <button class="btn btn-primary" onclick="syncDcIndex()">å¼€å§‹åŒæ­¥</button>
                    <div id="result-dc-index" class="result"></div>
                </div>

                <!-- åŒèŠ±é¡ºæ¿å—æˆåˆ† -->
                <div class="sync-card">
                    <h3>ğŸ“‹ åŒèŠ±é¡ºæ¿å—æˆåˆ†</h3>
                    <div class="form-group">
                        <label>æ¿å—ä»£ç ï¼ˆç•™ç©ºåˆ™å…¨éƒ¨ï¼‰</label>
                        <input type="text" id="ths_member_ts_code" placeholder="885800.TI">
                    </div>
                    <button class="btn btn-primary" onclick="syncThsMember()">å¼€å§‹åŒæ­¥</button>
                    <div id="result-ths-member" class="result"></div>
                </div>

                <!-- ä¸œæ–¹è´¢å¯Œæ¿å—æˆåˆ† -->
                <div class="sync-card">
                    <h3>ğŸ“‹ ä¸œæ–¹è´¢å¯Œæ¿å—æˆåˆ†</h3>
                    <div class="form-group">
                        <label>æ¿å—ä»£ç ï¼ˆç•™ç©ºåˆ™å…¨éƒ¨ï¼‰</label>
                        <input type="text" id="dc_member_ts_code" placeholder="BK1184.DC">
                    </div>
                    <div class="form-group">
                        <label>äº¤æ˜“æ—¥æœŸï¼ˆå¯é€‰ï¼‰</label>
                        <input type="text" id="dc_member_trade_date" placeholder="20251219" maxlength="8">
                    </div>
                    <button class="btn btn-primary" onclick="syncDcMember()">å¼€å§‹åŒæ­¥</button>
                    <div id="result-dc-member" class="result"></div>
                </div>

                <!-- åŒèŠ±é¡ºæ¿å—è¡Œæƒ… -->
                <div class="sync-card">
                    <h3>ğŸ“ˆ åŒèŠ±é¡ºæ¿å—è¡Œæƒ…</h3>
                    <div class="form-group">
                        <label>å¼€å§‹æ—¥æœŸ</label>
                        <input type="text" id="ths_daily_start_date" placeholder="20231201" maxlength="8">
                    </div>
                    <div class="form-group">
                        <label>ç»“æŸæ—¥æœŸ</label>
                        <input type="text" id="ths_daily_end_date" placeholder="20231231" maxlength="8">
                    </div>
                    <button class="btn btn-primary" onclick="syncThsDaily()">å¼€å§‹åŒæ­¥</button>
                    <div id="result-ths-daily" class="result"></div>
                </div>

                <!-- ä¸œæ–¹è´¢å¯Œæ¿å—è¡Œæƒ… -->
                <div class="sync-card">
                    <h3>ğŸ“ˆ ä¸œæ–¹è´¢å¯Œæ¿å—è¡Œæƒ…</h3>
                    <div class="form-group">
                        <label>å¼€å§‹æ—¥æœŸ</label>
                        <input type="text" id="dc_daily_start_date" placeholder="20231201" maxlength="8">
                    </div>
                    <div class="form-group">
                        <label>ç»“æŸæ—¥æœŸ</label>
                        <input type="text" id="dc_daily_end_date" placeholder="20231231" maxlength="8">
                    </div>
                    <div class="form-group">
                        <label>æ¿å—ç±»å‹ï¼ˆå¯é€‰ï¼‰</label>
                        <select id="dc_daily_idx_type">
                            <option value="">å…¨éƒ¨</option>
                            <option value="æ¦‚å¿µæ¿å—">æ¦‚å¿µæ¿å—</option>
                            <option value="è¡Œä¸šæ¿å—">è¡Œä¸šæ¿å—</option>
                            <option value="åœ°åŸŸæ¿å—">åœ°åŸŸæ¿å—</option>
                        </select>
                    </div>
                    <button class="btn btn-primary" onclick="syncDcDaily()">å¼€å§‹åŒæ­¥</button>
                    <div id="result-dc-daily" class="result"></div>
                </div>
            </div>
        </div>

        <!-- ç³»ç»ŸçŠ¶æ€ -->
        <div class="status-panel">
            <h3>ğŸ” ç³»ç»ŸçŠ¶æ€</h3>
            <div class="status-item">
                <strong>APIåœ°å€ï¼š</strong><span id="api-url">http://localhost:5001</span>
            </div>
            <div class="status-item">
                <strong>è¿æ¥çŠ¶æ€ï¼š</strong><span id="connection-status">æ£€æŸ¥ä¸­...</span>
            </div>
        </div>
    </div>

    <script>
        const API_BASE = 'http://localhost:5001';

        // æ£€æŸ¥APIè¿æ¥çŠ¶æ€
        async function checkHealth() {
            try {
                const response = await fetch(`${API_BASE}/health`);
                const data = await response.json();
                document.getElementById('connection-status').innerHTML = 
                    '<span style="color: #28a745;">âœ“ å·²è¿æ¥</span>';
            } catch (error) {
                document.getElementById('connection-status').innerHTML = 
                    '<span style="color: #dc3545;">âœ— æœªè¿æ¥</span>';
            }
        }

        // æ˜¾ç¤ºç»“æœ
        function showResult(elementId, message, type) {
            const element = document.getElementById(elementId);
            element.textContent = message;
            element.className = `result ${type}`;
        }

        // åŸºç¡€æ•°æ®åŒæ­¥
        async function syncBase() {
            const btn = event.target;
            btn.disabled = true;
            showResult('result-base', 'æ­£åœ¨åŒæ­¥åŸºç¡€æ•°æ®...', 'loading');

            try {
                const response = await fetch(`${API_BASE}/api/sync/base`, {
                    method: 'POST'
                });
                const data = await response.json();
                
                if (response.ok) {
                    showResult('result-base', 
                        `âœ“ åŒæ­¥æˆåŠŸï¼è‚¡ç¥¨åˆ—è¡¨: ${data.stock_list}æ¡, è‚¡ä¸œæŒè‚¡: ${data.stock_holder}æ¡, æ¸¸èµ„åå½•: ${data.stock_hot_money}æ¡`, 
                        'success');
                } else {
                    showResult('result-base', `âœ— åŒæ­¥å¤±è´¥: ${data.error}`, 'error');
                }
            } catch (error) {
                showResult('result-base', `âœ— è¯·æ±‚å¤±è´¥: ${error.message}`, 'error');
            } finally {
                btn.disabled = false;
            }
        }

        // å•æ—¥æ•°æ®åŒæ­¥
        async function syncDaily() {
            const tsCode = document.getElementById('daily_ts_code').value.trim();
            const tradeDate = document.getElementById('trade_date').value.trim();
            if (!tradeDate || !/^\d{8}$/.test(tradeDate)) {
                showResult('result-daily', 'âœ— è¯·è¾“å…¥æ­£ç¡®çš„æ—¥æœŸæ ¼å¼ï¼ˆYYYYMMDDï¼‰', 'error');
                return;
            }

            const btn = event.target;
            btn.disabled = true;
            showResult('result-daily', `æ­£åœ¨åŒæ­¥ ${tradeDate} çš„æ•°æ®...`, 'loading');

            try {
                const body = { trade_date: tradeDate };
                if (tsCode) body.ts_codes = tsCode;
                
                const response = await fetch(`${API_BASE}/api/sync/daily`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(body)
                });
                const data = await response.json();
                
                if (response.ok) {
                    if (data.skipped) {
                        showResult('result-daily', `âš  æ—¥æœŸ ${tradeDate} å·²åŒæ­¥ï¼Œè·³è¿‡`, 'success');
                    } else {
                        const details = data.details || {};
                        let msg = `âœ“ åŒæ­¥æˆåŠŸï¼å…± ${data.total_count} æ¡\n`;
                        msg += `æ—¥çº¿: ${details.stock_daily || 0}, ç­¹ç : ${details.stock_chip || 0}, æŠ€æœ¯å› å­: ${details.stock_tech_factor || 0}, æŠ€æœ¯å› å­Pro: ${details.stock_tech_factor_pro || 0}\n`;
                        msg += `èµ„é‡‘æµ: ${details.stock_money_flow || 0}, THSèµ„é‡‘: ${details.stock_money_flow_ths || 0}, DCèµ„é‡‘: ${details.stock_money_flow_dc || 0}\n`;
                        msg += `é¾™è™æ¦œ: ${details.stock_lhb_daily || 0}, æœºæ„: ${details.stock_lhb_inst || 0}\n`;
                        msg += `THSæ¿å—èµ„é‡‘: ${details.block_ths_money_flow || 0}, THSè¡Œä¸šèµ„é‡‘: ${details.industry_ths_money_flow || 0}\n`;
                        msg += `DCæ¿å—èµ„é‡‘: ${details.block_dc_money_flow || 0}, DCè¡Œä¸šèµ„é‡‘: ${details.industry_dc_money_flow || 0}\n`;
                        msg += `THSæ¿å—è¡Œæƒ…: ${details.ths_daily || 0}, DCæ¿å—è¡Œæƒ…: ${details.dc_daily || 0}\n`;
                        msg += `æ¶¨åœ: ${details.stock_limit_status || 0}, è¿æ¿: ${details.stock_limit_ladder || 0}, å¼ºåŠ¿æ¿å—: ${details.block_limit_strong || 0}\n`;
                        msg += `æ¸¸èµ„æ˜ç»†: ${details.stock_hot_money_daily || 0}`;
                        showResult('result-daily', msg, 'success');
                    }
                } else {
                    showResult('result-daily', `âœ— åŒæ­¥å¤±è´¥: ${data.error}`, 'error');
                }
            } catch (error) {
                showResult('result-daily', `âœ— è¯·æ±‚å¤±è´¥: ${error.message}`, 'error');
            } finally {
                btn.disabled = false;
            }
        }

        // æ—¥æœŸèŒƒå›´åŒæ­¥
        async function syncRange() {
            const tsCode = document.getElementById('range_ts_code').value.trim();
            const startDate = document.getElementById('start_date').value.trim();
            const endDate = document.getElementById('end_date').value.trim();
            
            if (!startDate || !/^\d{8}$/.test(startDate)) {
                showResult('result-range', 'âœ— è¯·è¾“å…¥æ­£ç¡®çš„å¼€å§‹æ—¥æœŸæ ¼å¼ï¼ˆYYYYMMDDï¼‰', 'error');
                return;
            }
            if (!endDate || !/^\d{8}$/.test(endDate)) {
                showResult('result-range', 'âœ— è¯·è¾“å…¥æ­£ç¡®çš„ç»“æŸæ—¥æœŸæ ¼å¼ï¼ˆYYYYMMDDï¼‰', 'error');
                return;
            }

            const btn = event.target;
            btn.disabled = true;
            showResult('result-range', `æ­£åœ¨åŒæ­¥ ${startDate} è‡³ ${endDate} çš„æ•°æ®...`, 'loading');

            try {
                const body = { start_date: startDate, end_date: endDate };
                if (tsCode) body.ts_codes = tsCode;
                
                const response = await fetch(`${API_BASE}/api/sync/daily`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(body)
                });
                const data = await response.json();
                
                if (response.ok) {
                    const details = data.details || {};
                    let msg = `âœ“ åŒæ­¥æˆåŠŸï¼å…± ${data.total_count} æ¡ï¼ˆ${data.synced_dates || 0} å¤©ï¼‰\n`;
                    msg += `æ—¥çº¿: ${details.stock_daily || 0}, ç­¹ç : ${details.stock_chip || 0}, æŠ€æœ¯å› å­: ${details.stock_tech_factor || 0}, æŠ€æœ¯å› å­Pro: ${details.stock_tech_factor_pro || 0}\n`;
                    msg += `èµ„é‡‘æµ: ${details.stock_money_flow || 0}, THSèµ„é‡‘: ${details.stock_money_flow_ths || 0}, DCèµ„é‡‘: ${details.stock_money_flow_dc || 0}\n`;
                    msg += `é¾™è™æ¦œ: ${details.stock_lhb_daily || 0}, æœºæ„: ${details.stock_lhb_inst || 0}\n`;
                    msg += `THSæ¿å—èµ„é‡‘: ${details.block_ths_money_flow || 0}, THSè¡Œä¸šèµ„é‡‘: ${details.industry_ths_money_flow || 0}\n`;
                    msg += `DCæ¿å—èµ„é‡‘: ${details.block_dc_money_flow || 0}, DCè¡Œä¸šèµ„é‡‘: ${details.industry_dc_money_flow || 0}\n`;
                    msg += `THSæ¿å—è¡Œæƒ…: ${details.ths_daily || 0}, DCæ¿å—è¡Œæƒ…: ${details.dc_daily || 0}\n`;
                    msg += `æ¶¨åœ: ${details.stock_limit_status || 0}, è¿æ¿: ${details.stock_limit_ladder || 0}, å¼ºåŠ¿æ¿å—: ${details.block_limit_strong || 0}\n`;
                    msg += `æ¸¸èµ„æ˜ç»†: ${details.stock_hot_money_daily || 0}`;
                    showResult('result-range', msg, 'success');
                } else {
                    showResult('result-range', `âœ— åŒæ­¥å¤±è´¥: ${data.error}`, 'error');
                }
            } catch (error) {
                showResult('result-range', `âœ— è¯·æ±‚å¤±è´¥: ${error.message}`, 'error');
            } finally {
                btn.disabled = false;
            }
        }

        // è‚¡ç¥¨åˆ—è¡¨åŒæ­¥
        async function syncStockList() {
            const btn = event.target;
            btn.disabled = true;
            showResult('result-stock-list', 'æ­£åœ¨åŒæ­¥è‚¡ç¥¨åˆ—è¡¨...', 'loading');

            try {
                const response = await fetch(`${API_BASE}/api/sync/stock_list`, {
                    method: 'POST'
                });
                const data = await response.json();
                
                if (response.ok) {
                    showResult('result-stock-list', 
                        `âœ“ åŒæ­¥æˆåŠŸï¼å…±åŒæ­¥ ${data.count} æ¡è‚¡ç¥¨æ•°æ®`, 
                        'success');
                } else {
                    showResult('result-stock-list', `âœ— åŒæ­¥å¤±è´¥: ${data.error}`, 'error');
                }
            } catch (error) {
                showResult('result-stock-list', `âœ— è¯·æ±‚å¤±è´¥: ${error.message}`, 'error');
            } finally {
                btn.disabled = false;
            }
        }

        // è‚¡ä¸œæŒè‚¡åŒæ­¥
        async function syncStockHolder() {
            const btn = event.target;
            btn.disabled = true;
            showResult('result-stock-holder', 'æ­£åœ¨åŒæ­¥è‚¡ä¸œæŒè‚¡æ•°æ®...', 'loading');

            try {
                const response = await fetch(`${API_BASE}/api/sync/stock_holder`, {
                    method: 'POST'
                });
                const data = await response.json();
                
                if (response.ok) {
                    showResult('result-stock-holder', 
                        `âœ“ åŒæ­¥æˆåŠŸï¼å…±åŒæ­¥ ${data.count} æ¡æŒè‚¡æ•°æ®`, 
                        'success');
                } else {
                    showResult('result-stock-holder', `âœ— åŒæ­¥å¤±è´¥: ${data.error}`, 'error');
                }
            } catch (error) {
                showResult('result-stock-holder', `âœ— è¯·æ±‚å¤±è´¥: ${error.message}`, 'error');
            } finally {
                btn.disabled = false;
            }
        }

        // æ¸¸èµ„åå½•åŒæ­¥
        async function syncHotMoney() {
            const btn = event.target;
            btn.disabled = true;
            showResult('result-hot-money', 'æ­£åœ¨åŒæ­¥æ¸¸èµ„åå½•...', 'loading');

            try {
                const response = await fetch(`${API_BASE}/api/sync/stock_hot_money`, {
                    method: 'POST'
                });
                const data = await response.json();
                
                if (response.ok) {
                    showResult('result-hot-money', 
                        `âœ“ åŒæ­¥æˆåŠŸï¼å…±åŒæ­¥ ${data.count} æ¡æ¸¸èµ„æ•°æ®`, 
                        'success');
                } else {
                    showResult('result-hot-money', `âœ— åŒæ­¥å¤±è´¥: ${data.error}`, 'error');
                }
            } catch (error) {
                showResult('result-hot-money', `âœ— è¯·æ±‚å¤±è´¥: ${error.message}`, 'error');
            } finally {
                btn.disabled = false;
            }
        }

        // æ—¥çº¿è¡Œæƒ…å•ç‹¬åŒæ­¥
        async function syncStockDailySingle() {
            const tsCode = document.getElementById('daily_ts_code').value.trim();
            const tradeDate = document.getElementById('daily_trade_date').value.trim();
            if (!tsCode || !tradeDate) {
                showResult('result-stock-daily', 'âœ— è¯·è¾“å…¥è‚¡ç¥¨ä»£ç å’Œäº¤æ˜“æ—¥æœŸ', 'error');
                return;
            }
            const btn = event.target;
            btn.disabled = true;
            showResult('result-stock-daily', 'æ­£åœ¨åŒæ­¥...', 'loading');
            try {
                const response = await fetch(`${API_BASE}/api/sync/stock_daily`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ ts_code: tsCode, trade_date: tradeDate })
                });
                const data = await response.json();
                if (response.ok) {
                    showResult('result-stock-daily', `âœ“ åŒæ­¥æˆåŠŸï¼${data.count} æ¡`, 'success');
                } else {
                    showResult('result-stock-daily', `âœ— ${data.error}`, 'error');
                }
            } catch (error) {
                showResult('result-stock-daily', `âœ— ${error.message}`, 'error');
            } finally {
                btn.disabled = false;
            }
        }

        // ç­¹ç åˆ†å¸ƒå•ç‹¬åŒæ­¥
        async function syncStockChipSingle() {
            const tsCode = document.getElementById('chip_ts_code').value.trim();
            const startDate = document.getElementById('chip_start_date').value.trim();
            const endDate = document.getElementById('chip_end_date').value.trim();
            
            if (!startDate || !endDate) {
                showResult('result-stock-chip', 'âœ— è¯·è¾“å…¥å¼€å§‹æ—¥æœŸå’Œç»“æŸæ—¥æœŸ', 'error');
                return;
            }
            
            const btn = event.target;
            btn.disabled = true;
            showResult('result-stock-chip', 'æ­£åœ¨åŒæ­¥...', 'loading');
            try {
                const body = { start_date: startDate, end_date: endDate };
                if (tsCode) body.ts_code = tsCode;
                
                const response = await fetch(`${API_BASE}/api/sync/stock_chip`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(body)
                });
                const data = await response.json();
                if (response.ok) {
                    showResult('result-stock-chip', `âœ“ åŒæ­¥æˆåŠŸï¼${data.count} æ¡`, 'success');
                } else {
                    showResult('result-stock-chip', `âœ— ${data.error}`, 'error');
                }
            } catch (error) {
                showResult('result-stock-chip', `âœ— ${error.message}`, 'error');
            } finally {
                btn.disabled = false;
            }
        }

        // æŠ€æœ¯å› å­å•ç‹¬åŒæ­¥
        async function syncStockTechFactorSingle() {
            const tsCode = document.getElementById('tech_ts_code').value.trim();
            const startDate = document.getElementById('tech_start_date').value.trim();
            const endDate = document.getElementById('tech_end_date').value.trim();
            if (!startDate || !endDate) {
                showResult('result-stock-tech', 'âœ— è¯·è¾“å…¥å¼€å§‹æ—¥æœŸå’Œç»“æŸæ—¥æœŸ', 'error');
                return;
            }
            const btn = event.target;
            btn.disabled = true;
            showResult('result-stock-tech', 'æ­£åœ¨åŒæ­¥...', 'loading');
            try {
                const response = await fetch(`${API_BASE}/api/sync/stock_tech_factor`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ ts_code: tsCode || null, start_date: startDate, end_date: endDate })
                });
                const data = await response.json();
                if (response.ok) {
                    showResult('result-stock-tech', `âœ“ åŒæ­¥æˆåŠŸï¼${data.count} æ¡`, 'success');
                } else {
                    showResult('result-stock-tech', `âœ— ${data.error}`, 'error');
                }
            } catch (error) {
                showResult('result-stock-tech', `âœ— ${error.message}`, 'error');
            } finally {
                btn.disabled = false;
            }
        }

        // æŠ€æœ¯å› å­ä¸“ä¸šç‰ˆå•ç‹¬åŒæ­¥
        async function syncStockTechFactorProSingle() {
            const tsCode = document.getElementById('tech_pro_ts_code').value.trim();
            const startDate = document.getElementById('tech_pro_start_date').value.trim();
            const endDate = document.getElementById('tech_pro_end_date').value.trim();
            
            if (!startDate || !endDate) {
                showResult('result-stock-tech-pro', 'âœ— è¯·è¾“å…¥å¼€å§‹æ—¥æœŸå’Œç»“æŸæ—¥æœŸ', 'error');
                return;
            }
            
            const btn = event.target;
            btn.disabled = true;
            showResult('result-stock-tech-pro', 'æ­£åœ¨åŒæ­¥...', 'loading');
            try {
                const body = { start_date: startDate, end_date: endDate };
                if (tsCode) body.ts_code = tsCode;
                
                const response = await fetch(`${API_BASE}/api/sync/stock_tech_factor_pro`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(body)
                });
                const data = await response.json();
                if (response.ok) {
                    showResult('result-stock-tech-pro', `âœ“ åŒæ­¥æˆåŠŸï¼${data.count} æ¡`, 'success');
                } else {
                    showResult('result-stock-tech-pro', `âœ— ${data.error}`, 'error');
                }
            } catch (error) {
                showResult('result-stock-tech-pro', `âœ— ${error.message}`, 'error');
            } finally {
                btn.disabled = false;
            }
        }

        // åŒèŠ±é¡ºä¸ªè‚¡èµ„é‡‘æµåŒæ­¥
        async function syncStockMoneyFlowThs() {
            const startDate = document.getElementById('money_ths_start_date').value.trim();
            const endDate = document.getElementById('money_ths_end_date').value.trim();
            if (!startDate || !endDate) {
                showResult('result-stock-money-ths', 'âœ— è¯·è¾“å…¥å¼€å§‹å’Œç»“æŸæ—¥æœŸ', 'error');
                return;
            }
            const btn = event.target;
            btn.disabled = true;
            showResult('result-stock-money-ths', 'æ­£åœ¨åŒæ­¥...', 'loading');
            try {
                const response = await fetch(`${API_BASE}/api/sync/stock_money_flow_ths`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ start_date: startDate, end_date: endDate })
                });
                const data = await response.json();
                if (response.ok) {
                    showResult('result-stock-money-ths', `âœ“ åŒæ­¥æˆåŠŸï¼${data.dates}ä¸ªäº¤æ˜“æ—¥ï¼Œå…±${data.count}æ¡`, 'success');
                } else {
                    showResult('result-stock-money-ths', `âœ— ${data.error}`, 'error');
                }
            } catch (error) {
                showResult('result-stock-money-ths', `âœ— ${error.message}`, 'error');
            } finally {
                btn.disabled = false;
            }
        }

        // ä¸œæ–¹è´¢å¯Œä¸ªè‚¡èµ„é‡‘æµåŒæ­¥
        async function syncStockMoneyFlowDc() {
            const startDate = document.getElementById('money_dc_start_date').value.trim();
            const endDate = document.getElementById('money_dc_end_date').value.trim();
            if (!startDate || !endDate) {
                showResult('result-stock-money-dc', 'âœ— è¯·è¾“å…¥å¼€å§‹å’Œç»“æŸæ—¥æœŸ', 'error');
                return;
            }
            const btn = event.target;
            btn.disabled = true;
            showResult('result-stock-money-dc', 'æ­£åœ¨åŒæ­¥...', 'loading');
            try {
                const response = await fetch(`${API_BASE}/api/sync/stock_money_flow_dc`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ start_date: startDate, end_date: endDate })
                });
                const data = await response.json();
                if (response.ok) {
                    showResult('result-stock-money-dc', `âœ“ åŒæ­¥æˆåŠŸï¼${data.dates}ä¸ªäº¤æ˜“æ—¥ï¼Œå…±${data.count}æ¡`, 'success');
                } else {
                    showResult('result-stock-money-dc', `âœ— ${data.error}`, 'error');
                }
            } catch (error) {
                showResult('result-stock-money-dc', `âœ— ${error.message}`, 'error');
            } finally {
                btn.disabled = false;
            }
        }

        // ä¸œæ–¹è´¢å¯Œæ¿å—èµ„é‡‘æµåŒæ­¥
        async function syncBlockDcMoneyFlow() {
            const startDate = document.getElementById('block_dc_start_date').value.trim();
            const endDate = document.getElementById('block_dc_end_date').value.trim();
            if (!startDate || !endDate) {
                showResult('result-block-dc-money', 'âœ— è¯·è¾“å…¥å¼€å§‹å’Œç»“æŸæ—¥æœŸ', 'error');
                return;
            }
            const btn = event.target;
            btn.disabled = true;
            showResult('result-block-dc-money', 'æ­£åœ¨åŒæ­¥...', 'loading');
            try {
                const response = await fetch(`${API_BASE}/api/sync/block_dc_money_flow`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ start_date: startDate, end_date: endDate })
                });
                const data = await response.json();
                if (response.ok) {
                    showResult('result-block-dc-money', `âœ“ åŒæ­¥æˆåŠŸï¼${data.dates}ä¸ªäº¤æ˜“æ—¥ï¼Œå…±${data.count}æ¡`, 'success');
                } else {
                    showResult('result-block-dc-money', `âœ— ${data.error}`, 'error');
                }
            } catch (error) {
                showResult('result-block-dc-money', `âœ— ${error.message}`, 'error');
            } finally {
                btn.disabled = false;
            }
        }

        // ä¸œæ–¹è´¢å¯Œè¡Œä¸šèµ„é‡‘æµåŒæ­¥
        async function syncIndustryDcMoneyFlow() {
            const startDate = document.getElementById('industry_dc_start_date').value.trim();
            const endDate = document.getElementById('industry_dc_end_date').value.trim();
            if (!startDate || !endDate) {
                showResult('result-industry-dc-money', 'âœ— è¯·è¾“å…¥å¼€å§‹å’Œç»“æŸæ—¥æœŸ', 'error');
                return;
            }
            const btn = event.target;
            btn.disabled = true;
            showResult('result-industry-dc-money', 'æ­£åœ¨åŒæ­¥...', 'loading');
            try {
                const response = await fetch(`${API_BASE}/api/sync/industry_dc_money_flow`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ start_date: startDate, end_date: endDate })
                });
                const data = await response.json();
                if (response.ok) {
                    showResult('result-industry-dc-money', `âœ“ åŒæ­¥æˆåŠŸï¼${data.dates}ä¸ªäº¤æ˜“æ—¥ï¼Œå…±${data.count}æ¡`, 'success');
                } else {
                    showResult('result-industry-dc-money', `âœ— ${data.error}`, 'error');
                }
            } catch (error) {
                showResult('result-industry-dc-money', `âœ— ${error.message}`, 'error');
            } finally {
                btn.disabled = false;
            }
        }

        // æ¿å—èµ„é‡‘æµå•ç‹¬åŒæ­¥
        async function syncBlockMoneyFlowSingle() {
            const startDate = document.getElementById('block_start_date').value.trim();
            const endDate = document.getElementById('block_end_date').value.trim();
            if (!startDate || !endDate) {
                showResult('result-block-money', 'âœ— è¯·è¾“å…¥å¼€å§‹æ—¥æœŸå’Œç»“æŸæ—¥æœŸ', 'error');
                return;
            }
            const btn = event.target;
            btn.disabled = true;
            showResult('result-block-money', 'æ­£åœ¨åŒæ­¥...', 'loading');
            try {
                const response = await fetch(`${API_BASE}/api/sync/block_ths_money_flow`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ start_date: startDate, end_date: endDate })
                });
                const data = await response.json();
                if (response.ok) {
                    showResult('result-block-money', `âœ“ åŒæ­¥æˆåŠŸï¼${data.dates}ä¸ªäº¤æ˜“æ—¥ï¼Œå…±${data.count}æ¡`, 'success');
                } else {
                    showResult('result-block-money', `âœ— ${data.error}`, 'error');
                }
            } catch (error) {
                showResult('result-block-money', `âœ— ${error.message}`, 'error');
            } finally {
                btn.disabled = false;
            }
        }

        // è¡Œä¸šèµ„é‡‘æµå•ç‹¬åŒæ­¥
        async function syncIndustryMoneyFlowSingle() {
            const startDate = document.getElementById('industry_start_date').value.trim();
            const endDate = document.getElementById('industry_end_date').value.trim();
            if (!startDate || !endDate) {
                showResult('result-industry-money', 'âœ— è¯·è¾“å…¥å¼€å§‹æ—¥æœŸå’Œç»“æŸæ—¥æœŸ', 'error');
                return;
            }
            const btn = event.target;
            btn.disabled = true;
            showResult('result-industry-money', 'æ­£åœ¨åŒæ­¥...', 'loading');
            try {
                const response = await fetch(`${API_BASE}/api/sync/industry_ths_money_flow`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ start_date: startDate, end_date: endDate })
                });
                const data = await response.json();
                if (response.ok) {
                    showResult('result-industry-money', `âœ“ åŒæ­¥æˆåŠŸï¼${data.dates}ä¸ªäº¤æ˜“æ—¥ï¼Œå…±${data.count}æ¡`, 'success');
                } else {
                    showResult('result-industry-money', `âœ— ${data.error}`, 'error');
                }
            } catch (error) {
                showResult('result-industry-money', `âœ— ${error.message}`, 'error');
            } finally {
                btn.disabled = false;
            }
        }

        // é¾™è™æ¦œæ¯æ—¥å•ç‹¬åŒæ­¥
        async function syncStockLhbDailySingle() {
            const tsCode = document.getElementById('lhb_ts_code').value.trim();
            const tradeDate = document.getElementById('lhb_trade_date').value.trim();
            if (!tradeDate) {
                showResult('result-lhb-daily', 'âœ— è¯·è¾“å…¥äº¤æ˜“æ—¥æœŸ', 'error');
                return;
            }
            const btn = event.target;
            btn.disabled = true;
            showResult('result-lhb-daily', 'æ­£åœ¨åŒæ­¥...', 'loading');
            try {
                const body = { trade_date: tradeDate };
                if (tsCode) body.ts_code = tsCode;
                const response = await fetch(`${API_BASE}/api/sync/stock_lhb_daily`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(body)
                });
                const data = await response.json();
                if (response.ok) {
                    showResult('result-lhb-daily', `âœ“ åŒæ­¥æˆåŠŸï¼${data.count} æ¡`, 'success');
                } else {
                    showResult('result-lhb-daily', `âœ— ${data.error}`, 'error');
                }
            } catch (error) {
                showResult('result-lhb-daily', `âœ— ${error.message}`, 'error');
            } finally {
                btn.disabled = false;
            }
        }

        // é¾™è™æ¦œæœºæ„å•ç‹¬åŒæ­¥
        async function syncStockLhbInstSingle() {
            const tsCode = document.getElementById('lhb_inst_ts_code').value.trim();
            const tradeDate = document.getElementById('lhb_inst_trade_date').value.trim();
            if (!tradeDate) {
                showResult('result-lhb-inst', 'âœ— è¯·è¾“å…¥äº¤æ˜“æ—¥æœŸ', 'error');
                return;
            }
            const btn = event.target;
            btn.disabled = true;
            showResult('result-lhb-inst', 'æ­£åœ¨åŒæ­¥...', 'loading');
            try {
                const body = { trade_date: tradeDate };
                if (tsCode) body.ts_code = tsCode;
                const response = await fetch(`${API_BASE}/api/sync/stock_lhb_inst`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(body)
                });
                const data = await response.json();
                if (response.ok) {
                    showResult('result-lhb-inst', `âœ“ åŒæ­¥æˆåŠŸï¼${data.count} æ¡`, 'success');
                } else {
                    showResult('result-lhb-inst', `âœ— ${data.error}`, 'error');
                }
            } catch (error) {
                showResult('result-lhb-inst', `âœ— ${error.message}`, 'error');
            } finally {
                btn.disabled = false;
            }
        }

        // æ¶¨è·Œåœæ•°æ®å•ç‹¬åŒæ­¥
        async function syncStockLimitStatusSingle() {
            const startDate = document.getElementById('limit_status_start_date').value.trim();
            const endDate = document.getElementById('limit_status_end_date').value.trim();
            if (!startDate || !endDate) {
                showResult('result-limit-status', 'âœ— è¯·è¾“å…¥å¼€å§‹æ—¥æœŸå’Œç»“æŸæ—¥æœŸ', 'error');
                return;
            }
            const btn = event.target;
            btn.disabled = true;
            showResult('result-limit-status', 'æ­£åœ¨åŒæ­¥...', 'loading');
            try {
                const response = await fetch(`${API_BASE}/api/sync/stock_limit_status`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ start_date: startDate, end_date: endDate })
                });
                const data = await response.json();
                if (response.ok) {
                    showResult('result-limit-status', `âœ“ åŒæ­¥æˆåŠŸï¼${data.dates}ä¸ªäº¤æ˜“æ—¥ï¼Œå…±${data.count}æ¡`, 'success');
                } else {
                    showResult('result-limit-status', `âœ— ${data.error}`, 'error');
                }
            } catch (error) {
                showResult('result-limit-status', `âœ— ${error.message}`, 'error');
            } finally {
                btn.disabled = false;
            }
        }

        // è¿æ¿å¤©æ¢¯å•ç‹¬åŒæ­¥
        async function syncStockLimitLadderSingle() {
            const tradeDate = document.getElementById('limit_ladder_trade_date').value.trim();
            if (!tradeDate) {
                showResult('result-limit-ladder', 'âœ— è¯·è¾“å…¥äº¤æ˜“æ—¥æœŸ', 'error');
                return;
            }
            const btn = event.target;
            btn.disabled = true;
            showResult('result-limit-ladder', 'æ­£åœ¨åŒæ­¥...', 'loading');
            try {
                const response = await fetch(`${API_BASE}/api/sync/stock_limit_ladder`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ trade_date: tradeDate })
                });
                const data = await response.json();
                if (response.ok) {
                    showResult('result-limit-ladder', `âœ“ åŒæ­¥æˆåŠŸï¼${data.count} æ¡`, 'success');
                } else {
                    showResult('result-limit-ladder', `âœ— ${data.error}`, 'error');
                }
            } catch (error) {
                showResult('result-limit-ladder', `âœ— ${error.message}`, 'error');
            } finally {
                btn.disabled = false;
            }
        }

        // å¼ºåŠ¿æ¿å—å•ç‹¬åŒæ­¥
        async function syncBlockLimitStrongSingle() {
            const tradeDate = document.getElementById('block_strong_trade_date').value.trim();
            if (!tradeDate) {
                showResult('result-block-strong', 'âœ— è¯·è¾“å…¥äº¤æ˜“æ—¥æœŸ', 'error');
                return;
            }
            const btn = event.target;
            btn.disabled = true;
            showResult('result-block-strong', 'æ­£åœ¨åŒæ­¥...', 'loading');
            try {
                const response = await fetch(`${API_BASE}/api/sync/block_limit_strong`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ trade_date: tradeDate })
                });
                const data = await response.json();
                if (response.ok) {
                    showResult('result-block-strong', `âœ“ åŒæ­¥æˆåŠŸï¼${data.count} æ¡`, 'success');
                } else {
                    showResult('result-block-strong', `âœ— ${data.error}`, 'error');
                }
            } catch (error) {
                showResult('result-block-strong', `âœ— ${error.message}`, 'error');
            } finally {
                btn.disabled = false;
            }
        }

        // æ¸¸èµ„æ¯æ—¥æ˜ç»†å•ç‹¬åŒæ­¥
        async function syncStockHotMoneyDailySingle() {
            const tsCode = document.getElementById('hm_daily_ts_code').value.trim();
            const tradeDate = document.getElementById('hm_daily_trade_date').value.trim();
            if (!tradeDate) {
                showResult('result-hm-daily', 'âœ— è¯·è¾“å…¥äº¤æ˜“æ—¥æœŸ', 'error');
                return;
            }
            const btn = event.target;
            btn.disabled = true;
            showResult('result-hm-daily', 'æ­£åœ¨åŒæ­¥...', 'loading');
            try {
                const body = { trade_date: tradeDate };
                if (tsCode) body.ts_code = tsCode;
                const response = await fetch(`${API_BASE}/api/sync/stock_hot_money_daily`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(body)
                });
                const data = await response.json();
                if (response.ok) {
                    showResult('result-hm-daily', `âœ“ åŒæ­¥æˆåŠŸï¼${data.count} æ¡`, 'success');
                } else {
                    showResult('result-hm-daily', `âœ— ${data.error}`, 'error');
                }
            } catch (error) {
                showResult('result-hm-daily', `âœ— ${error.message}`, 'error');
            } finally {
                btn.disabled = false;
            }
        }

        // åŒèŠ±é¡ºæ¿å—åŒæ­¥
        async function syncThsIndex() {
            const tsCode = document.getElementById('ths_index_ts_code').value.trim();
            const exchange = document.getElementById('ths_index_exchange').value;
            const type = document.getElementById('ths_index_type').value;
            const btn = event.target;
            btn.disabled = true;
            showResult('result-ths-index', 'æ­£åœ¨åŒæ­¥...', 'loading');
            try {
                const body = {};
                if (tsCode) body.ts_code = tsCode;
                if (exchange) body.exchange = exchange;
                if (type) body.type = type;
                const response = await fetch(`${API_BASE}/api/sync/ths_index`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(body)
                });
                const data = await response.json();
                if (response.ok) {
                    showResult('result-ths-index', `âœ“ åŒæ­¥æˆåŠŸï¼${data.count} æ¡`, 'success');
                } else {
                    showResult('result-ths-index', `âœ— ${data.error}`, 'error');
                }
            } catch (error) {
                showResult('result-ths-index', `âœ— ${error.message}`, 'error');
            } finally {
                btn.disabled = false;
            }
        }

        // åŒèŠ±é¡ºæ¿å—æˆåˆ†åŒæ­¥
        async function syncThsMember() {
            const tsCode = document.getElementById('ths_member_ts_code').value.trim();
            const btn = event.target;
            btn.disabled = true;
            showResult('result-ths-member', 'æ­£åœ¨åŒæ­¥...', 'loading');
            try {
                const body = {};
                if (tsCode) body.ts_code = tsCode;
                const response = await fetch(`${API_BASE}/api/sync/ths_member`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(body)
                });
                const data = await response.json();
                if (response.ok) {
                    showResult('result-ths-member', `âœ“ åŒæ­¥æˆåŠŸï¼${data.count} æ¡`, 'success');
                } else {
                    showResult('result-ths-member', `âœ— ${data.error}`, 'error');
                }
            } catch (error) {
                showResult('result-ths-member', `âœ— ${error.message}`, 'error');
            } finally {
                btn.disabled = false;
            }
        }

        // åŒèŠ±é¡ºæ¿å—è¡Œæƒ…åŒæ­¥
        async function syncThsDaily() {
            const startDate = document.getElementById('ths_daily_start_date').value.trim();
            const endDate = document.getElementById('ths_daily_end_date').value.trim();
            if (!startDate || !endDate) {
                showResult('result-ths-daily', 'âœ— è¯·è¾“å…¥å¼€å§‹å’Œç»“æŸæ—¥æœŸ', 'error');
                return;
            }
            const btn = event.target;
            btn.disabled = true;
            showResult('result-ths-daily', 'æ­£åœ¨åŒæ­¥...', 'loading');
            try {
                const response = await fetch(`${API_BASE}/api/sync/ths_daily`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ start_date: startDate, end_date: endDate })
                });
                const data = await response.json();
                if (response.ok) {
                    showResult('result-ths-daily', `âœ“ åŒæ­¥æˆåŠŸï¼${data.dates}ä¸ªäº¤æ˜“æ—¥ï¼Œå…±${data.count}æ¡`, 'success');
                } else {
                    showResult('result-ths-daily', `âœ— ${data.error}`, 'error');
                }
            } catch (error) {
                showResult('result-ths-daily', `âœ— ${error.message}`, 'error');
            } finally {
                btn.disabled = false;
            }
        }

        // ä¸œæ–¹è´¢å¯Œæ¿å—åŒæ­¥
        async function syncDcIndex() {
            const tsCode = document.getElementById('dc_index_ts_code').value.trim();
            const name = document.getElementById('dc_index_name').value.trim();
            const tradeDate = document.getElementById('dc_index_trade_date').value.trim();
            const btn = event.target;
            btn.disabled = true;
            showResult('result-dc-index', 'æ­£åœ¨åŒæ­¥...', 'loading');
            try {
                const body = {};
                if (tsCode) body.ts_code = tsCode;
                if (name) body.name = name;
                if (tradeDate) body.trade_date = tradeDate;
                const response = await fetch(`${API_BASE}/api/sync/dc_index`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(body)
                });
                const data = await response.json();
                if (response.ok) {
                    showResult('result-dc-index', `âœ“ åŒæ­¥æˆåŠŸï¼${data.count} æ¡`, 'success');
                } else {
                    showResult('result-dc-index', `âœ— ${data.error}`, 'error');
                }
            } catch (error) {
                showResult('result-dc-index', `âœ— ${error.message}`, 'error');
            } finally {
                btn.disabled = false;
            }
        }

        // ä¸œæ–¹è´¢å¯Œæ¿å—æˆåˆ†åŒæ­¥
        async function syncDcMember() {
            const tsCode = document.getElementById('dc_member_ts_code').value.trim();
            const tradeDate = document.getElementById('dc_member_trade_date').value.trim();
            const btn = event.target;
            btn.disabled = true;
            showResult('result-dc-member', 'æ­£åœ¨åŒæ­¥...', 'loading');
            try {
                const body = {};
                if (tsCode) body.ts_code = tsCode;
                if (tradeDate) body.trade_date = tradeDate;
                const response = await fetch(`${API_BASE}/api/sync/dc_member`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(body)
                });
                const data = await response.json();
                if (response.ok) {
                    showResult('result-dc-member', `âœ“ åŒæ­¥æˆåŠŸï¼${data.count} æ¡`, 'success');
                } else {
                    showResult('result-dc-member', `âœ— ${data.error}`, 'error');
                }
            } catch (error) {
                showResult('result-dc-member', `âœ— ${error.message}`, 'error');
            } finally {
                btn.disabled = false;
            }
        }

        // ä¸œæ–¹è´¢å¯Œæ¿å—è¡Œæƒ…åŒæ­¥
        async function syncDcDaily() {
            const startDate = document.getElementById('dc_daily_start_date').value.trim();
            const endDate = document.getElementById('dc_daily_end_date').value.trim();
            const idxType = document.getElementById('dc_daily_idx_type').value;
            if (!startDate || !endDate) {
                showResult('result-dc-daily', 'âœ— è¯·è¾“å…¥å¼€å§‹å’Œç»“æŸæ—¥æœŸ', 'error');
                return;
            }
            const btn = event.target;
            btn.disabled = true;
            showResult('result-dc-daily', 'æ­£åœ¨åŒæ­¥...', 'loading');
            try {
                const body = { start_date: startDate, end_date: endDate };
                if (idxType) body.idx_type = idxType;
                const response = await fetch(`${API_BASE}/api/sync/dc_daily`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(body)
                });
                const data = await response.json();
                if (response.ok) {
                    showResult('result-dc-daily', `âœ“ åŒæ­¥æˆåŠŸï¼${data.dates}ä¸ªäº¤æ˜“æ—¥ï¼Œå…±${data.count}æ¡`, 'success');
                } else {
                    showResult('result-dc-daily', `âœ— ${data.error}`, 'error');
                }
            } catch (error) {
                showResult('result-dc-daily', `âœ— ${error.message}`, 'error');
            } finally {
                btn.disabled = false;
            }
        }

        // é¡µé¢åŠ è½½æ—¶æ£€æŸ¥è¿æ¥
        window.onload = function() {
            checkHealth();
            // è®¾ç½®é»˜è®¤æ—¥æœŸä¸ºæ˜¨å¤©
            const yesterday = new Date();
            yesterday.setDate(yesterday.getDate() - 1);
            const dateStr = yesterday.toISOString().slice(0, 10).replace(/-/g, '');
            document.getElementById('trade_date').value = dateStr;
        };
    </script>
</body>
</html>
